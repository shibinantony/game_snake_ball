<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake & Frog Game</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #222;
            margin: 0;
            font-family: sans-serif;
            overflow: hidden; /* Prevent scrollbars if game board is large */
        }

        #game-container {
            text-align: center;
        }

        #game-board {
            display: grid;
            /* grid-template-columns and grid-template-rows will be set by JavaScript */
            border: 5px solid #fff;
            background-color: #000;
            margin-bottom: 20px;
            box-sizing: content-box; /* Ensure border adds to size, not shrinks content */
        }

        .game-cell {
            /* width and height will be set by JavaScript based on board size and CELL_SIZE */
        }

        .snake {
            background-color: #0f0; /* Green for the snake */
        }

        .frog {
            background-color: #f00; /* Red for the frog */
            border-radius: 50%; /* Make the frog round */
        }

        #score {
            color: #fff;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        #game-over {
            color: #fff;
            font-size: 2em;
            display: none; /* Hidden by default */
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="score">Score: 0</div>
        <div id="game-board">
            </div>
        <div id="game-over">Game Over! Press any arrow key to restart.</div>
    </div>

    <script>
        // --- Game Constants ---
        const GRID_SIZE = 20; // Number of cells wide/high
        const CELL_SIZE = 20; // Size of each cell in pixels
        const INITIAL_GAME_SPEED = 200; // Milliseconds between game updates (lower = faster)
        const SCORE_THRESHOLD = 100; // Score to reach for bonus/speed increase
        const BONUS_POINTS_PER_FROG = 50;
        const INITIAL_POINTS_PER_FROG = 10;
        const SPEED_MULTIPLIER = 1.5; // Factor to increase speed by

        // --- Game Variables ---
        const gameBoard = document.getElementById('game-board');
        const scoreDisplay = document.getElementById('score');
        const gameOverDisplay = document.getElementById('game-over');

        let snake = [{ x: 10, y: 10 }]; // Initial snake position (head)
        let frog = { x: 15, y: 5 };     // Initial frog position
        let direction = { x: 0, y: -1 }; // Initial direction (up)
        let score = 0;
        let gameInterval;
        let currentGameSpeed = INITIAL_GAME_SPEED;
        let isGameOver = false;
        let changingDirection = false; // Flag to prevent rapid direction changes
        let pointsPerFrog = INITIAL_POINTS_PER_FROG; // Variable for dynamic points
        let speedIncreased = false; // Flag to ensure speed increase happens only once

        // --- Game Setup ---
        function setupGameBoard() {
            gameBoard.style.width = `${GRID_SIZE * CELL_SIZE}px`;
            gameBoard.style.height = `${GRID_SIZE * CELL_SIZE}px`;
            gameBoard.style.gridTemplateColumns = `repeat(${GRID_SIZE}, ${CELL_SIZE}px)`;
            gameBoard.style.gridTemplateRows = `repeat(${GRID_SIZE}, ${CELL_SIZE}px)`;
        }

        // --- Drawing Functions ---
        function draw() {
            // Clear previous drawing
            gameBoard.innerHTML = '';

            // Draw Snake
            snake.forEach(segment => {
                const snakeElement = document.createElement('div');
                snakeElement.style.gridColumnStart = segment.x + 1;
                snakeElement.style.gridRowStart = segment.y + 1;
                snakeElement.classList.add('game-cell', 'snake');
                gameBoard.appendChild(snakeElement);
            });

            // Draw Frog
            const frogElement = document.createElement('div');
            frogElement.style.gridColumnStart = frog.x + 1;
            frogElement.style.gridRowStart = frog.y + 1;
            frogElement.classList.add('game-cell', 'frog');
            gameBoard.appendChild(frogElement);
        }

        // --- Game Logic ---
        function moveSnake() {
            if (isGameOver) return;

            changingDirection = false; // Reset flag

            const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };
            snake.unshift(head); // Add new head

            // Check if snake ate the frog
            if (head.x === frog.x && head.y === frog.y) {
                score += pointsPerFrog; // Use the dynamic points value
                scoreDisplay.textContent = `Score: ${score}`;
                generateFrog(); // Place a new frog

                // --- Check and apply bonus/speed increase ---
                if (score >= SCORE_THRESHOLD && !speedIncreased) {
                    pointsPerFrog = BONUS_POINTS_PER_FROG; // Increase points per frog
                    currentGameSpeed = INITIAL_GAME_SPEED / SPEED_MULTIPLIER; // Calculate new speed (lower interval = faster)
                    speedIncreased = true; // Set flag so this only happens once

                    // Clear the old interval and start a new one with the increased speed
                    clearInterval(gameInterval);
                    gameInterval = setInterval(moveSnake, currentGameSpeed);
                    console.log("Speed increased and points changed!"); // Optional log
                }
                // Don't remove tail, snake grows
            } else {
                snake.pop(); // Remove tail
            }

            // Check for collisions after moving and potentially eating
            if (checkCollision()) {
                endGame();
            } else {
                draw(); // Redraw only if game is not over
            }
        }

        function checkCollision() {
            const head = snake[0];

            // Check wall collision
            if (head.x < 0 || head.x >= GRID_SIZE || head.y < 0 || head.y >= GRID_SIZE) {
                return true;
            }

            // Check self collision (start checking from the 2nd segment)
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return true;
                }
            }

            return false;
        }

        function generateFrog() {
            // Keep generating random positions until we find one not occupied by the snake
            while (true) {
                frog = {
                    x: Math.floor(Math.random() * GRID_SIZE),
                    y: Math.floor(Math.random() * GRID_SIZE)
                };

                let collisionWithSnake = false;
                for (let i = 0; i < snake.length; i++) {
                    if (frog.x === snake[i].x && frog.y === snake[i].y) {
                        collisionWithSnake = true;
                        break;
                    }
                }

                if (!collisionWithSnake) {
                    break; // Found a valid spot
                }
            }
            // The frog will be drawn in the next `draw()` call within the game loop
        }

        function changeDirection(event) {
            if (changingDirection || isGameOver) return;
            changingDirection = true;

            const keyPressed = event.keyCode;
            const LEFT_ARROW = 37;
            const UP_ARROW = 38;
            const RIGHT_ARROW = 39;
            const DOWN_ARROW = 40;

            // Prevent reversing direction immediately
            const goingUp = direction.y === -1;
            const goingDown = direction.y === 1;
            const goingLeft = direction.x === -1;
            const goingRight = direction.x === 1;

            if (keyPressed === LEFT_ARROW && !goingRight) {
                direction = { x: -1, y: 0 };
            } else if (keyPressed === UP_ARROW && !goingDown) {
                direction = { x: 0, y: -1 };
            } else if (keyPressed === RIGHT_ARROW && !goingLeft) {
                direction = { x: 1, y: 0 };
            } else if (keyPressed === DOWN_ARROW && !goingUp) {
                direction = { x: 0, y: 1 };
            }

            // If game is over and an arrow key is pressed, restart
            if (isGameOver && (keyPressed >= 37 && keyPressed <= 40)) {
                restartGame();
            }
        }

        function startGame() {
            isGameOver = false;
            gameOverDisplay.style.display = 'none';
            score = 0;
            scoreDisplay.textContent = `Score: ${score}`;
            snake = [{ x: 10, y: 10 }];
            direction = { x: 0, y: -1 }; // Start moving up
            currentGameSpeed = INITIAL_GAME_SPEED; // Reset speed
            pointsPerFrog = INITIAL_POINTS_PER_FROG; // Reset points
            speedIncreased = false; // Reset speed increase flag

            generateFrog(); // Place initial frog
            draw(); // Initial draw

            // Clear any existing interval before starting a new one
            clearInterval(gameInterval);
            gameInterval = setInterval(moveSnake, currentGameSpeed);
        }

        function endGame() {
            clearInterval(gameInterval);
            isGameOver = true;
            gameOverDisplay.style.display = 'block';
        }

        function restartGame() {
             // Give a slight delay before restarting to prevent accidental immediate restart
             setTimeout(startGame, 100);
        }

        // --- Initialization ---
        document.addEventListener('keydown', changeDirection);

        // Set up the board size based on constants
        setupGameBoard();

        // Start the game when the page loads
        startGame();

    </script>
</body>
</html>